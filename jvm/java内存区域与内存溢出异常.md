# 第二章  java内存区域和内存溢出异常

## 运行时数据区域

总的图如下：
![java运行时数据区域][1]

### 方法区
```
功能：1.用于存储已经被虚拟机加载的 类信息，常量，静态变量，即时编译器编译后的代码等数据.
     2.是各个线程共享的内存区域.
     
虚拟机对该区域的要求： 不需要连续内存，可以选择固定大小，可以不实现垃圾收集.
    HotSpot 虚拟机会对这里进行 常量池的回收 和 类型的卸载。此区域又称为永久代（只在HotSpot中）

异常： 此区域内存无法满足需求时，抛出 OutOfMemoryError异常.
```

### java堆
```
功能： 1. 几乎所有 对象实例 和 数组 都要在堆上分配.
      2. java堆是所有线程共享的一块java虚拟机管理的区域.也是最大的一块区域.
      
介绍：java堆是垃圾回收机制回收垃圾的主要区域.其内部分为新生代 和 老年代. 还可以再细分，后面垃圾回收会说. 
     分区主要目的是：更加合理方便的回收垃圾（就是这里的无用的对象实例）
     
要求： java对可以处于物理上不连续的内存空间中，逻辑上连续即可.

异常： java堆中空间不够，并且堆无法扩展时，抛出 OutOfMemoryError.
```

### 虚拟机栈
```
功能： 1. java方法执行的内存模型.即，每个方法在执行的同时，都会创建一个栈帧。
        栈帧：用于存储局部变量表。操作数栈，动态链接，方法出口等信息.
        每一个方法从调用到执行结束，就对应着一个栈帧在虚拟机栈入栈出栈的过程.
      2. java虚拟机栈是线程私有的，他的生命周期与线程相同.
      
介绍： 1. 局部变量表：存放编译期可知的 基本数据类型，对象引用，返回类型.
      2.局部变量表在编译期间大小就完全确定，方法运行期间不会改变局部变量表的大小.
      
异常：1.栈深度大于虚拟机允许的最大深度，抛出 StackOverFlowError.
      2.虚拟机栈扩展时无法申请到足够内存,抛出 OutOfMemoryError.
      
```

### 程序计数器
```
功能：通过改变这个计数器的值（字节码的行号），来使字节码解析器取得下一条要执行的字节码指令.

介绍：1.每个线程都需要一个独立的程序计数器. 线程私有. 
      2.如果是Native方法，则计数器值为null.
      3.此内存区域是虚拟机中唯一一个没有规范任何 OutOfMemoryError的区域.
```

### 本地方法栈
```
功能：为虚拟机执行本地的Native方法服务的区域.
        Native方法就是用非java语言写的方法.
        
异常：StackOverFlowError 和 OutOfMemoryError.
```







































  [1]: https://upload-images.jianshu.io/upload_images/2614605-246286b040ad10c1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/578